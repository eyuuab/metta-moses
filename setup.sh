#!/bin/bash

git clone https://github.com/patham9/PeTTa

cd PeTTa || exit

if ! grep -q "^#!/bin/bash" run.sh; then
    sed -i '1i#!/bin/bash' run.sh
fi

SCRIPT_DIR="$(pwd)/src/main.pl"
MORK_DIR="$(pwd)/mork_ffi/target/release/libmork_ffi.so"

sed -i "s|./src/main.pl|$SCRIPT_DIR|" run.sh
sed -i "s|./mork_ffi/target/release/libmork_ffi.so|$MORK_DIR|" run.sh

chmod +x run.sh

repo_path=$(pwd)
if ! echo "$PATH" | grep -q "$repo_path"; then
    export PATH="$PATH:$repo_path"
    echo "export PATH=\$PATH:$repo_path" >> ~/.bashrc
    source ~/.bashrc
fi